# 解决 Git 推送大文件问题

## 问题描述

推送时遇到以下错误：
```
错误：无法回退rpc post数据 - 尝试增大http.postBuffer
错误：RPC失败；curl 65 接收失败：连接已重置
```

## 已应用的解决方案

我已经为您配置了以下 Git 设置：

```bash
git config --global http.postBuffer 524288000  # 500MB 缓冲区
git config --global http.maxRequestBuffer 100M
git config --global core.compression 0
```

## 现在请再次尝试推送

在 PowerShell 中执行：

```powershell
cd "C:\Users\Administrator\Desktop\S9\s9-VocabularyLesson2.0-v1.0"
git push -u origin main
```

## 如果仍然失败，尝试以下方法

### 方法 1：使用优化脚本

运行我创建的优化脚本：

```powershell
powershell -ExecutionPolicy Bypass -File .\push_large_files.ps1
```

### 方法 2：分批推送

如果文件太大，可以分批推送：

```powershell
# 先推送部分文件
git add src/
git commit -m "Add source files"
git push -u origin main

# 然后推送其他文件
git add .
git commit -m "Add remaining files"
git push origin main
```

### 方法 3：检查并排除大文件

检查是否有不应该推送的大文件：

```powershell
# 查找大于 50MB 的文件
git ls-files | ForEach-Object {
    $size = (Get-Item $_ -ErrorAction SilentlyContinue).Length
    if ($size -gt 50MB) {
        Write-Host "$_ : $([math]::Round($size/1MB, 2)) MB"
    }
}
```

如果发现不应该推送的文件（如 `node_modules`、`dist` 等），确保它们在 `.gitignore` 中：

```bash
# 从 Git 中移除但保留本地文件
git rm -r --cached node_modules
git rm -r --cached dist
git commit -m "Remove large directories"
```

### 方法 4：使用 Git LFS（大文件存储）

如果确实需要推送大文件，使用 Git LFS：

```powershell
# 安装 Git LFS（如果未安装）
# 下载：https://git-lfs.github.com/

# 初始化 Git LFS
git lfs install

# 跟踪大文件类型
git lfs track "*.zip"
git lfs track "*.exe"
git lfs track "*.dll"

# 添加 .gitattributes
git add .gitattributes
git commit -m "Add Git LFS tracking"
git push -u origin main
```

### 方法 5：使用 SSH 代替 HTTPS

SSH 通常对大文件推送更稳定：

```powershell
# 1. 生成 SSH 密钥（如果还没有）
ssh-keygen -t ed25519 -C "your_email@example.com"

# 2. 将公钥添加到 GitHub
# 复制 ~/.ssh/id_ed25519.pub 的内容
# 添加到：https://github.com/settings/keys

# 3. 更改远程 URL 为 SSH
git remote set-url origin git@github.com:GHVBUGB/S9-2.0.git

# 4. 推送
git push -u origin main
```

### 方法 6：增加超时时间

```powershell
git config --global http.lowSpeedLimit 0
git config --global http.lowSpeedTime 999999
git push -u origin main
```

## 当前项目状态

- ✅ Git 仓库已初始化
- ✅ 远程仓库已配置（包含 token）
- ✅ `.gitignore` 已配置（排除 node_modules、dist 等）
- ✅ HTTP 缓冲区已增大到 500MB
- ✅ 压缩已禁用（加快推送速度）

## 验证推送

推送成功后，访问：
**https://github.com/GHVBUGB/S9-2.0**

## 常见问题

### Q: 为什么推送这么慢？
A: 您的项目有 842 个对象，总大小约 24MB。这是正常的，请耐心等待。

### Q: 可以取消压缩吗？
A: 已经设置了 `core.compression 0`，这应该会加快推送速度。

### Q: 网络不稳定怎么办？
A: 可以尝试：
1. 使用更稳定的网络连接
2. 使用 SSH 代替 HTTPS
3. 分批推送文件

### Q: 推送到一半断开了怎么办？
A: Git 会记住已推送的部分，重新执行 `git push -u origin main` 即可继续。

## 快速命令

```powershell
# 一键推送（已优化配置）
cd "C:\Users\Administrator\Desktop\S9\s9-VocabularyLesson2.0-v1.0"
git config --global http.postBuffer 524288000
git config --global http.maxRequestBuffer 100M
git config --global core.compression 0
git push -u origin main
```

